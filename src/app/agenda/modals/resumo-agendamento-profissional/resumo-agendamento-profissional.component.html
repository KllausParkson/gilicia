<ion-header
  mode="md"
  style="background-color: var(--cor-fundo-barraTopo) !important"
>
  <ion-toolbar color="primary">
    <div class="overlay" *ngIf="overlayDivControl == true"></div>
    <ion-title
      *ngIf="segment == 'info'"
      style="color: var(--cor-texto-barraTopo)"
    >
      {{
        "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.TITLERESUMO"
          | translate
      }}
    </ion-title>
    <ion-title
      *ngIf="segment == 'lancarProdutoServico'"
      style="color: var(--cor-texto-barraTopo)"
    >
      {{
        "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.TITLELANCAR"
          | translate
      }}
    </ion-title>
    <ion-buttons slot="primary">
      <ion-button  *ngIf="segment == 'info'" (click)="closeModal()">
        <ion-icon
          name="close"
          slot="icon-only"
          style="transform: scale(1.5); color: var(--cor-texto-barraTopo)"
        ></ion-icon>
      </ion-button>
      <ion-button 
        *ngIf="segment == 'lancarProdutoServico'"
        (click)="voltarSegment()"
      >
        <ion-icon
          name="close"
          slot="icon-only"
          style="transform: scale(1.5); color: var(--cor-texto-barraTopo)"
        ></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="backgroundContentApp" scrollY="false" fullscreen>
  <div class="overlay" *ngIf="overlayDivControl == true"></div>

  <ng-container [ngSwitch]="segment">
    <ion-list
      *ngSwitchCase="'info'"
      style="height: 100%; overflow-y: auto"
    >
      <ion-card class="backgroundCard">
        <ion-card-content >
          <ion-col
            size="12"
            *ngIf="possuiFicha == false"
            style="
              display: flex;
              align-items: flex-end;
              justify-content: space-between;
            "
          >
            <kendo-floatinglabel
              #floating_cliente
              style="width: 80%; margin-bottom: 3px"
              text="*{{
                'AGENDA.MODALS.NOVOAGENDAMENTOPROFISSIONAL.CLIENTE' | translate
              }}"
            >
              <kendo-combobox
                style="border: none"
                [data]="listClientes"
                [filterable]="true"
                (filterChange)="pesquisaClientes($event)"
                (valueChange)="changeCliente($event)"
                [textField]="'nomeCliente'"
                [valueField]="'clienteId'"
                [loading]="pesquisaClienteLoader"
                [value]="clienteSelecionado"
                [allowCustom]="true"
                [valueNormalizer]="valueNormalizer"
              >
                <!--  [disabled]="(editarAgendamento == 0 ? false: true)"-->
                <ng-template kendoComboBoxItemTemplate let-dataItem>
                  <ion-row>
                    <ion-col>
                      <ion-row>
                        {{
                          "AGENDA.MODALS.NOVOAGENDAMENTOPROFISSIONAL.INFOCLIENTE.NAME"
                            | translate
                        }}: {{ dataItem.nomeCliente }}
                      </ion-row>
                      <ion-row>
                        {{
                          "AGENDA.MODALS.NOVOAGENDAMENTOPROFISSIONAL.INFOCLIENTE.EMAIL"
                            | translate
                        }}: {{ dataItem.email }}
                      </ion-row>
                      <ion-row>
                        {{
                          "AGENDA.MODALS.NOVOAGENDAMENTOPROFISSIONAL.INFOCLIENTE.PHONE"
                            | translate
                        }}: {{ dataItem.celular }}
                      </ion-row>
                    </ion-col>
                  </ion-row>
                </ng-template>
                <ng-template kendoComboBoxNoDataTemplate>
                  <ion-row>
                    {{ "AGENDA.BUSCANAORETORNOURESULTADO" | translate }}
                  </ion-row>
                </ng-template>
              </kendo-combobox>
            </kendo-floatinglabel>
            <ion-button>
            <span (click)="clientesPresentes()" style="color:white;text-align: center;
            font-weight: bold;">
              Ver presenças
            </span>
          </ion-button>
          </ion-col>
          <ion-row
            *ngIf="possuiFicha !== true"
            class="ion-justify-content-center"
          >
            <ng-container *ngIf="cliPresentesSegment == true">
              <ion-segment
                mode="md"
                class="SwipedTabs-tabs colorTextApp"
                [ngClass]="{
                'SwipedTabs-tabs-scrollable': ScroolClientesPresentes,
                'SwipedTabs-tabs': !ScroolClientesPresentes
                }"
                style="overflow-x: scroll"
                [ngStyle]="{
                  'justify-content':
                    listClientesPresentes != undefined &&
                    listClientesPresentes?.length == 0
                      ? 'center'
                      : 'unset'
                }"
                scrollable
              >
                <ng-container *ngIf="clientesPresentesRetornou">
                  <ng-container *ngIf="listClientesPresentes != undefined">
                    <ion-segment-button
                      *ngFor="
                        let clientePresente of listClientesPresentes;
                        index as i
                      "
                      id="segment-{{ i }}"
                      (click)="selectTabClientePresente(i)"
                      style="width: 90px"
                    >
                      <!-- [ngClass]="{ 'SwipedTabs-activeTab' : ( SwipedTabsSlider  && ( SwipedTabsSlider.getActiveIndex() == i || (  tabs?.length -1 == i && SwipedTabsSlider.isEnd()))) }" -->
                      <div>
                        <img
                          [src]="
                            'https://oneproducao.blob.core.windows.net/one2/Imagens/Sem_FotoPerfil.png'
                          "
                          style="transform: scale(1); border-radius: 50%"
                        />
                        <br />
                        <ion-row style="height: 20px">
                          <span style="font-size: 10px; padding-top: 5px">{{
                            clientePresente.nomeCliente?.substr(0, 10)
                          }}</span>
                        </ion-row>
                      </div>
                    </ion-segment-button>
                  </ng-container>
                </ng-container>
                <ng-container
                  *ngIf="
                    listClientesPresentes != undefined &&
                    listClientesPresentes?.length == 0
                  "
                >
                  <ion-row style="color: #8d8d8d; text-align: right">
                    {{
                      "AGENDA.MODALS.NOVOAGENDAMENTOPROFISSIONAL.ALLCLIENTSABSENT"
                        | translate
                    }}
                  </ion-row>
                </ng-container>
              </ion-segment>
            </ng-container>
          </ion-row>

          <!--  <ion-row *ngIf="possuiFicha == true">
            <ion-item style="left: 20%" lines="none" text-wrap>
              <ion-avatar slot="start" class="imagemOne"><img src="{{clienteSelecionado?.fotoUrl || semLogo}}"></ion-avatar>
              <ion-label class="ion-text-wrap" style="font-size: 12px; color: #969696;">{{'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.CLIENTE' | translate}}<br><span style="font-size: 12px; color: #3d3d3d;">{{ dadosAgendamento.nomeCliente }}</span></ion-label>
            </ion-item>
          </ion-row> -->

          <ng-container *ngIf="naotemcliente == false">
            <ion-card-content>
              <ion-row>
                <ion-col
                  style="
                    text-align: center;
                    font-size: 18px;
                    color: var(--ion-color-primary);
                  "
                >
                  {{
                    "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.INFOAGENDAMENTO"
                      | translate
                  }}
                </ion-col>
              </ion-row>
              <ion-row>
                <span style="justify-content: center; font-weight: bold">
                  {{
                    "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.CLIENTE"
                      | translate
                  }}: &nbsp;
                </span>
                <span
                  style="
                    justify-content: center;
                    font-size: 14px;
                    text-align: center;
                    text-transform: capitalize;
                  "
                >
                  {{ dadosAgendamento.nomeCliente?.toLowerCase() }}
                </span>
              </ion-row>
              <!-- <ion-row>
                <span style="justify-content: center; font-weight: bold">
                  {{
                    "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.SERVICO"
                      | translate
                  }}: &nbsp;
                </span>
                <span
                  style="
                    justify-content: center;
                    font-size: 14px;
                    text-align: center;
                  "
                >
                  {{ dadosAgendamento.descricaoServico }}
                </span>
              </ion-row> -->
              <ion-row>
                <span style="justify-content: center; font-weight: bold">
                  {{
                    "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.HORARIO"
                      | translate
                  }}: &nbsp;
                  <!-- Chave de tradução faltante -->
                </span>
                <span
                  style="
                    justify-content: center;
                    font-size: 14px;
                    text-align: center;
                    text-transform: capitalize;
                  "
                >
                  {{ dadosAgendamento.horarioInicio?.substr(0, 5) }} -
                  {{ dadosAgendamento.horarioFim?.substr(0, 5) }}
                </span>
              </ion-row>
              <!-- <ion-row>
              <ion-col size="4">
                <ion-row style="justify-content: center;  font-weight: bold;">
                  {{'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.CLIENTE' | translate}}
                </ion-row>
                <ion-row style="justify-content: center; font-size: 14px; text-align: center; text-transform: capitalize;">
                  {{ dadosAgendamento.nomeCliente?.toLowerCase() }}
                </ion-row>
              </ion-col>
              <ion-col size="3">
                <ion-row style="justify-content: center; font-weight: bold;">
                  {{ 'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.SERVICO' | translate }}
                </ion-row>
                <ion-row style="justify-content: center; font-size: 14px;">
                  {{ dadosAgendamento.descricaoServico }}
                </ion-row>
              </ion-col>
              <ion-col size="5">
                <ion-row style="justify-content: center;  font-weight: bold;">
                  Horário
                </ion-row>
                <ion-row style="justify-content: center; font-size: 14px;">
                  {{ dadosAgendamento.horarioInicio?.substr(0,5) }} - {{ dadosAgendamento.horarioFim?.substr(0,5) }}
                </ion-row>
              </ion-col>   
            </ion-row> -->
            </ion-card-content>
          </ng-container>

          <ng-container
            *ngIf="
              listProdutosRegistrados?.length == 0 &&
              listServicosRegistrados?.length == 0
            "
          >
            <ion-row class="aviso-row" style="font-size: 32px;">
              <ion-icon
                name="alert-circle-outline"
              ></ion-icon>
            </ion-row>
            <ion-row class="aviso-row" style="font-size: 18px;">
              <ion-label class="colorTextApp">{{
                "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.SEMLANCAMENTOS"
                  | translate
              }}</ion-label>
            </ion-row>
          </ng-container>

          <ng-container *ngIf="listProdutosRegistrados?.length != 0">
            <ion-row class="titulo">
              {{
                "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.PRODUTOS"
                  | translate
              }}
            </ion-row>

            <!-- <div style="max-height: 100px; overflow-y: auto;"> -->
            <ng-container
              *ngFor="let elementoFicha of listProdutosRegistrados; index as i"
            >
              <ion-row
                *ngIf="elementoFicha.produtoId"
                style="
                  border-bottom: 1px solid #e9e9e9;
                  display: flex;
                  align-items: baseline;
                "
              >
                <!-- 
                  Tabela de produtos, essas ion-cols juntas definem qual é o produto cadastrado
                  para o cliente
                 -->
                <ion-col size="4.5">
                  <span>
                    <div
                      class="nomeServico"
                      mat-raised-button
                      (click)="exibeNome(elementoFicha.produtoDescricao, false)"
                    >
                      <ion-icon
                        name="information-circle-outline"
                        style="
                          margin-right: 2px;
                          color: var(--ion-color-primary);
                        "
                      ></ion-icon>
                      {{ elementoFicha.produtoDescricao }}
                    </div>
                  </span>
                </ion-col>
                <ion-col size="1.5" style="padding-right: 0%">
                  <kendo-numerictextbox
                    class="quantityFieldProduct keyboardnumeric"
                    style="
                      border: 1px solid transparent;
                      text-align-last: start;
                    "
                    [autoCorrect]="true"
                    [disabled]="elementoFicha.editionDeactivated"
                    [format]="'n'"
                    [step]="1"
                    [(value)]="elementoFicha.quantidade"
                    [min]="1"
                    [max]="null"
                    [spinners]="false"
                    (click)="setKeyboardNumeric($event)"
                  >
                  </kendo-numerictextbox>
                </ion-col>
                <ion-col
                  size="0.5"
                  style="padding-left: 0%; color: darkgray; font-size: 14px"
                  >x</ion-col
                >
                <ion-col size="4.5">
                  <kendo-numerictextbox
                    class="priceFieldProduct keyboardnumeric"
                    style="
                      border: 1px solid transparent;
                      text-align-last: center;
                    "
                    [autoCorrect]="true"
                    [disabled]="elementoFicha.editionDeactivated"
                    [format]="formatOptions"
                    [step]="0.01"
                    [(value)]="elementoFicha.preco"
                    [spinners]="false"
                    (change) ="enableEditionProduct(i)"
                    [min]="elementoFicha.maxDiscount"
                    [max]="elementoFicha.maxPrice"
                    (click)="setKeyboardNumeric($event)"
                  >
                  </kendo-numerictextbox>
                </ion-col>

                <ion-col size="1">
                  <ion-icon
                    *ngIf="elementoFicha.editionDeactivated"
                    name="ellipsis-vertical-outline"
                    style="color: grey; transform: scale(1.5)"
                    (click)="onClickEdit($event, i, elementoFicha)"
                  ></ion-icon>
                  <ion-icon
                    *ngIf="!elementoFicha.editionDeactivated"
                    class="checkmarkConfirmEdit"
                    name="checkmark"
                    (click)="enableEditionProduct(i)"
                  ></ion-icon>
                </ion-col>
                <!-- <ion-col style=" top: 6px;" *ngIf="tipoUsuario == 'colaborador'">
                  <ion-icon *ngIf="elementoFicha.editionDeactivated" class="pencilEdit" name="pencil" (click)="enableEditionProduct(i)"></ion-icon>
                  <ion-icon *ngIf="!elementoFicha.editionDeactivated" class="checkmarkConfirmEdit" name="checkmark" (click)="enableEditionProduct(i)"></ion-icon>
                </ion-col>
                <ion-col style=" top: 5.2px;" *ngIf="tipoUsuario == 'colaborador'"><ion-icon class="deleteService" name="close" (click)="removingProductAlert(i)"></ion-icon></ion-col>
                 -->
              </ion-row>
            </ng-container>
            <!-- </div> -->

            <ion-row *ngIf="listProdutosRegistrados?.length > 1">
              <ion-col
                size="3.5"
                style="font-weight: bold; display: flex; align-items: end"
              >
                {{
                  "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.SUBTOTAL"
                    | translate
                }}
              </ion-col>
              <ion-col size="3.5">
                <kendo-numerictextbox class="keyboardnumeric"
                  style="border: 1px solid transparent; text-align-last: center"
                  [autoCorrect]="true"
                  [disabled]="true"
                  [format]="'n'"
                  [step]="1"
                  [(value)]="totalQuantityRegisteredProducts"
                  [min]="1"
                  [max]="null"
                  [spinners]="false"
                  (click)="setKeyboardNumeric($event)"
                >
                </kendo-numerictextbox>
                <!-- {{ totalQuantityRegisteredServices }} -->
              </ion-col>
              <ion-col size="5">
                <kendo-numerictextbox class="keyboardnumeric"
                  style="border: 1px solid transparent; text-align-last: left"
                  [autoCorrect]="true"
                  [disabled]="true"
                  [format]="formatOptions"
                  [step]="0.01"
                  [(value)]="totalPriceRegisteredProducts"
                  [spinners]="false"
                  [min]="0"
                  [max]="null"
                >
                </kendo-numerictextbox>
                <!-- {{ totalPriceRegisteredServices }} -->
              </ion-col>
            </ion-row>
          </ng-container>

          <ng-container *ngIf="listServicosRegistrados?.length != 0">
            <ion-row class="titulo">
              {{
                "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.SERVICOS"
                  | translate
              }}
            </ion-row>

            <ng-container
              *ngFor="let elementoFicha of listServicosRegistrados; index as i"
            >
              <div
                class="servicoRegistrado"
                [ngClass]="{
                  auxiliarAllowed:
                    elementoFicha.servicoAuxiliarID != null ? true : false
                }"
              >
                <ion-row class="colorTextApp"
                  *ngIf="elementoFicha.servicoId"
                  [ngStyle]="{
                    'border-bottom':
                      listServicosRegistrados[i] !== null &&
                      ((listServicosRegistrados[i].quimicas != null &&
                        listServicosRegistrados[i].quimicas?.length > 0) ||
                        (listServicosRegistrados[i].colaboradorAuxiliarID !==
                          null &&
                          listServicosRegistrados[i].colaboradorAuxiliarID !==
                            0))
                        ? 'unset'
                        : '1px solid #e9e9e9'
                  }"
                  style="display: flex; align-items: baseline"
                >
                  <!-- 
                    Tabela de Serviços, essas ion-cols juntas definem qual é o serviço cadastrado
                    para o cliente
                   -->
                  <ion-col size="4.5">
                    <span>
                      <div
                        class="nomeServico"
                        mat-raised-button
                        (click)="
                          exibeNome(elementoFicha.servicoDescricao, true)
                        "
                      >
                        <ion-icon
                          name="information-circle-outline"
                          style="
                            margin-right: 2px;
                            color: var(--ion-color-primary);
                          "
                        ></ion-icon>
                        {{ elementoFicha.servicoDescricao }}
                      </div>
                    </span>
                  </ion-col>

                  <ion-col size="1.5" style="padding-right: 0%">
                    <kendo-numerictextbox
                      class="quantityFieldService keyboardnumeric"
                      style="
                        border: 1px solid transparent;
                        text-align-last: start;
                      "
                      [autoCorrect]="true"
                      [disabled]="elementoFicha.editionDeactivated"
                      [format]="'n'"
                      [step]="1"
                      [(value)]="elementoFicha.quantidade"
                      [min]="1"
                      [max]="null"
                      [spinners]="false"
                      (click)="setKeyboardNumeric($event)"
                    >
                    </kendo-numerictextbox>
                  </ion-col>
                  <ion-col
                    size="0.5"
                    style="padding-left: 0%; color: darkgray; font-size: 14px"
                    >x</ion-col
                  >
                  <ion-col size="4.5">
                    <kendo-numerictextbox
                      class="priceFieldService keyboardnumeric"
                      style="
                        border: 1px solid transparent;
                        text-align-last: center;
                      "
                      [autoCorrect]="true"
                      [disabled]="elementoFicha.editionDeactivated"
                      [format]="formatOptions"
                      [step]="0.01"
                      [(value)]="elementoFicha.preco"
                      [spinners]="false"
                      (change) = "enableEditionService(i)"
                      [min]="elementoFicha.maxDiscount"
                      [max]="elementoFicha.maxPrice"
                      (click)="setKeyboardNumeric($event)"
                    >
                    </kendo-numerictextbox>
                  </ion-col>
                  <!-- 
                    <ion-col style=" top: 6px;" *ngIf="tipoUsuario == 'colaborador'">
                      <ion-icon *ngIf="elementoFicha.editionDeactivated" class="pencilEdit" name="pencil" (click)="enableEditionService(i)"></ion-icon>
                      <ion-icon *ngIf="!elementoFicha.editionDeactivated" class="checkmarkConfirmEdit" name="checkmark" (click)="enableEditionService(i)"></ion-icon>
                    </ion-col>
                    <ion-col style=" top: 5.2px;" *ngIf="tipoUsuario == 'colaborador'">
                      <ion-icon class="deleteService" name="close" (click)="removingServiceAlert(i)"></ion-icon>
                    </ion-col>
                   -->
                  <ion-col size="1">
                    <ion-icon
                      *ngIf="elementoFicha.editionDeactivated"
                      name="ellipsis-vertical-outline"
                      style="color: grey; transform: scale(1.5)"
                      (click)="onClickEdit($event, i, elementoFicha)"
                    ></ion-icon>
                    <ion-icon
                      *ngIf="!elementoFicha.editionDeactivated"
                      class="checkmarkConfirmEdit"
                      name="checkmark"
                      (click)="enableEditionService(i)"
                    ></ion-icon>
                  </ion-col>
                </ion-row>

                <ion-row *ngIf="elementoFicha.servicoAuxiliarID != null">
                  <ion-col size="12">
                    <kendo-floatinglabel
                      text="{{
                        'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.ELEMENTOAUXILIAR'
                          | translate
                      }}"
                    >
                      <kendo-combobox
                        class="auxiliarServicoSearch colorTextApp"
                        #comboboxAuxiliar
                        [placeholder]="'Pesquisar Auxiliar' | translate"
                        [disabled]="elementoFicha.editionDeactivated"
                        [data]="listColaboradoresAgendaveis"
                        [filterable]="true"
                        (filterChange)="pesquisaColaboradores($event)"
                        (valueChange)="editColaboradorAuxiliar($event, i)"
                        [textField]="'nomeProfissional'"
                        [valueField]="'profissionalId'"
                        [valueNormalizer]="valueNormalizer"
                        [value]="{
                          nomeProfissional:
                            elementoFicha.colaboradorAuxiliarNome,
                          profissionalId: elementoFicha.colaboradorAuxiliarID
                        }"
                        [allowCustom]="true"
                        [ngStyle]="{
                          border: 0,
                          'border-bottom':
                            listServicosRegistrados[i].quimicas !== undefined &&
                            listServicosRegistrados[i].quimicas !== null &&
                            listServicosRegistrados[i].quimicas?.length > 0
                              ? 'unset'
                              : '1px solid #e9e9e9'
                        }"
                      >
                        <!--[loading]="pesquisaClienteLoader"-->
                        <ng-template kendoComboBoxItemTemplate let-dataItem>
                          <ion-grid class="pesquisa-container">
                            <ion-row>
                              <ion-col>
                                {{
                                  "AGENDA.MODALS.NOVOAGENDAMENTOPROFISSIONAL.INFOCLIENTE.NAME"
                                    | translate
                                }}:{{ dataItem.nomeProfissional }}
                              </ion-col>
                            </ion-row>
                            <ion-row>
                              <ion-col size="12">
                                {{
                                  "AGENDA.MODALS.NOVOAGENDAMENTOPROFISSIONAL.INFOCLIENTE.EMAIL"
                                    | translate
                                }}: {{ dataItem.email }}
                              </ion-col>
                            </ion-row>
                            <ion-row>
                              <ion-col size="12">
                                {{
                                  "AGENDA.MODALS.NOVOAGENDAMENTOPROFISSIONAL.INFOCLIENTE.PHONE"
                                    | translate
                                }}: {{ dataItem.celular }}
                              </ion-col>
                            </ion-row>
                          </ion-grid>
                        </ng-template>
                        <ng-template kendoComboBoxNoDataTemplate>
                          <ion-row>
                            {{ "AGENDA.BUSCANAORETORNOURESULTADO" | translate }}
                          </ion-row>
                        </ng-template>
                      </kendo-combobox>
                    </kendo-floatinglabel>
                  </ion-col>
                </ion-row>

                <ng-container
                  style="border-bottom: 1px solid #e9e9e9"
                  *ngIf="
                    listServicosRegistrados[i] !== null &&
                    listServicosRegistrados[i].quimicas != null &&
                    listServicosRegistrados[i].quimicas?.length > 0
                  "
                >
                  <ion-row class="colorTextApp"
                    [ngStyle]="{
                      'border-bottom':
                        listServicosRegistrados[i].expandirQuimicaControl ===
                        false
                          ? '1px solid #e9e9e9'
                          : 'unset'
                    }"
                    (click)="expandirQuimicaResumo(i)"
                    style="display: flex; align-items: center; font-size: 13px"
                  >
                    <ion-icon
                      name="arrow-down"
                      style="
                        transform: scale(1.3);
                        padding-right: 3px;
                        padding-left: 5.5px;
                      "
                      *ngIf="
                        listServicosRegistrados[i].expandirQuimicaControl ==
                        true
                      "
                    ></ion-icon>
                    <ion-icon
                      name="arrow-forward"
                      style="
                        transform: scale(1.3);
                        padding-right: 3px;
                        padding-left: 5.5px;
                      "
                      *ngIf="
                        listServicosRegistrados[i].expandirQuimicaControl ==
                        false
                      "
                    ></ion-icon
                    >Quimicas:
                  </ion-row>
                  <ng-container
                    *ngIf="
                      listServicosRegistrados[i].expandirQuimicaControl == true
                    "
                  >
                    <ion-row
                      *ngFor="
                        let quimica of elementoFicha.quimicas;
                        index as resumoQuimicaIndex
                      "
                      style="
                        border-bottom: 1px solid #e9e9e9;
                        padding-left: 10px;
                        font-size: 13px;
                      "
                    >
                      <ion-col size="1"></ion-col>
                      <ion-col size="9" style="text-align: left">{{
                        quimica.produtoDescricao
                      }}</ion-col>
                      <ion-col size="1" style="bottom: 4px"
                        ><ion-icon
                          name="create"
                          style="transform: scale(1.5); color: gray"
                          (click)="
                            openModalEdicaoQuimica(i, resumoQuimicaIndex)
                          "
                        ></ion-icon
                      ></ion-col>
                      <!--<ion-col size="1" style=" bottom: 8px;"><ion-icon name="close" style="transform: scale(2.5); position: absolute; bottom: -8px; color: var(--ion-color-danger);" (click)="removingQuimicaAlert(i,resumoQuimicaIndex)"></ion-icon></ion-col>--><!--(click)="removerQuimica(i,j,quimicaIndex)"-->
                      <ion-col size="1"></ion-col>
                    </ion-row>
                  </ng-container>
                </ng-container>
              </div>
            </ng-container>
            <!-- </div> -->
            <ion-row *ngIf="listServicosRegistrados?.length > 1" style="color: var(--ion-color-primary)">
              <ion-col
                size="3.5"
                style="font-weight: bold; display: flex; align-items: end"
              >
                {{
                  "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.SUBTOTAL"
                    | translate
                }}
              </ion-col>
              <ion-col size="3.5">
                <kendo-numerictextbox class="keyboardnumeric"
                  style="border: 1px solid transparent; text-align-last: center"
                  [autoCorrect]="true"
                  [disabled]="true"
                  [format]="'n'"
                  [step]="1"
                  [(value)]="totalQuantityRegisteredServices"
                  [min]="1"
                  [max]="null"
                  [spinners]="false"
                  (click)="setKeyboardNumeric($event)"
                >
                </kendo-numerictextbox>
                <!-- {{ totalQuantityRegisteredServices }} -->
              </ion-col>
              <ion-col size="5">
                <kendo-numerictextbox class="keyboardnumeric"
                  style="border: 1px solid transparent; text-align-last: left"
                  [autoCorrect]="true"
                  [disabled]="true"
                  [format]="formatOptions"
                  [step]="0.01"
                  [(value)]="totalPriceRegisteredServices"
                  [spinners]="false"
                  [min]="0"
                  [max]="null"
                  (click)="setKeyboardNumeric($event)"
                >
                </kendo-numerictextbox>
                <!-- {{ totalPriceRegisteredServices }} -->
              </ion-col>
            </ion-row>
          </ng-container>

          <ng-container
            *ngIf="
              listServicosRegistrados?.length != 0 ||
              listProdutosRegistrados?.length != 0
            "
          >
            <ion-row style="padding-top: 10px; color: var(--ion-color-primary)">
              <ion-col
                size="3.5"
                style="font-weight: bold; display: flex; align-items: center"
              >
                {{
                  "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.TOTAL"
                    | translate
                }}
              </ion-col>
              <ion-col size="3.5">
                <kendo-numerictextbox
                  class="total keyboardnumeric"
                  style="border: 1px solid transparent; text-align-last: center"
                  [autoCorrect]="true"
                  [disabled]="true"
                  [format]="'n'"
                  [step]="1"
                  [(value)]="totalQuantityGeneral"
                  [min]="1"
                  [max]="null"
                  [spinners]="false"
                  (click)="setKeyboardNumeric($event)"
                >
                </kendo-numerictextbox>
                <!-- {{ totalQuantityRegisteredServices }} -->
              </ion-col>
              <ion-col size="5">
                <kendo-numerictextbox
                  class="total"
                  style="border: 1px solid transparent; text-align-last: left"
                  [autoCorrect]="true"
                  [disabled]="true"
                  [format]="formatOptions"
                  [step]="0.01"
                  [(value)]="totalPriceGeneral"
                  [spinners]="false"
                  [min]="0"
                  [max]="null"
                >
                </kendo-numerictextbox>
                <!-- {{ totalPriceRegisteredServices }} -->
              </ion-col>
            </ion-row>
          </ng-container>

          <ng-container
            *ngIf="
              registerServicePermission != undefined &&
              registerProductPermission != undefined
            "
          >
            <ion-row
              style="margin: 10px"
              *ngIf="
                registerServicePermission?.length != 0 ||
                registerProductPermission?.length != 0
              "
            >
              <ion-col size="12" style="padding-top: 20px">
                <ng-container
                  *ngIf="
                    naotemcliente == false &&
                    (parametrosLight.registrarServicos ||
                      tipoLogin === 'gestor')
                  "
                >
                  <ion-button 
                    class="gerarServicoProduto backgroundButtonApp"
                    expand="block"
                    type="submit"
                    *ngIf="tipoUsuario == 'colaborador'"
                    (click)="alertLancarTodosAgendamentos()"
                    [disabled]="
                      possuiFicha == false && clienteSelecionado != undefined
                        ? false
                        : possuiFicha == true
                        ? false
                        : true
                    "
                    ><!-- style="color: black; box-shadow: none; position: fixed; bottom: 20px; left: 0; right: 0;" -->
                    <!-- <ion-icon name="caret-forward-outline" style="zoom:1.7; padding-right: 5px;"></ion-icon> --><span
                      style="font-size: 14px" class="backgroundButtonApp"
                      >{{
                        "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTORAPIDO.BUTTON"
                          | translate
                      }}</span
                    >
                  </ion-button>
                </ng-container>
                <ion-button
                  class="gerarServicoProduto backgroundButtonApp"
                  expand="block"
                  type="submit"
                  *ngIf="
                    tipoUsuario == 'colaborador' &&
                    (parametrosLight.registrarServicos ||
                      parametrosLight.lancarProdutos)
                  "
                  (click)="lancarServicoProdutoModal()"
                  [disabled]="
                    possuiFicha == false && clienteSelecionado != undefined
                      ? false
                      : possuiFicha == true
                      ? false
                      : true
                  "
                  ><!-- style="color: black; box-shadow: none; position: fixed; bottom: 20px; left: 0; right: 0;" -->
                  <ion-icon
                    name="add"
                    style="transform: scale(1.5); padding-right: 5px"
                  ></ion-icon
                  ><span class="backgroundButtonApp" style="font-size: 14px">{{
                    "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.BUTTON"
                      | translate
                  }}</span>
                </ion-button>
              </ion-col>
            </ion-row>
          </ng-container>

          <!--  <ng-container *ngIf="dadosAgendamento.status != 'E' && segment == 'info' && dadosAgendamento.status != 'R' && possuiFicha == true">
            <ion-row style="margin: 10px;">
              <ion-col size="12" style="padding-top: 20px;">
                <ion-button 
                  class="gerarServicoProduto" 
                  expand="block" 
                  type="submit" 
                  (click)="buttonSlided()">
                 <ion-icon name="transgender" style="zoom:1.7; padding-right: 5px;"></ion-icon><span style="font-size: 14px;">Finalizar atendimento</span>
                </ion-button>
              </ion-col>
            </ion-row>
          </ng-container> -->
        </ion-card-content>
      </ion-card>

      <!-- <ion-card>
        <ion-card-content>
          <ion-row>
            <ion-col style="text-align: center; font-size: 18px; color: var(--ion-color-primary)">
              {{ 'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.INFOAGENDAMENTO' | translate }}
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="5">
              <ion-row style="justify-content: center; font-weight: bold;">
                {{ 'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.SERVICO' | translate }}
              </ion-row>
              <ion-row style="justify-content: center; font-size: 14px;">
                {{ dadosAgendamento.descricaoServico }}
              </ion-row>
            </ion-col>
            <ion-col size="1"></ion-col>
            <ion-col size="5">
              <ion-row style="justify-content: center;  font-weight: bold;">
                {{ 'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.HORARIOAGENDADO' | translate }}
              </ion-row>
              <ion-row style="justify-content: center; font-size: 14px;">
                {{ dadosAgendamento.horarioInicio?.substr(0,5) }} - {{ dadosAgendamento.horarioFim?.substr(0,5) }}
              </ion-row>
            </ion-col>
          </ion-row>

        </ion-card-content>

      </ion-card> -->
    </ion-list>
    <ion-list
      id="testando"
      *ngSwitchCase="'lancarProdutoServico'"
      style=" height: 100%;"
    >
      <ion-segment
        mode="ios"
        color="primary"
        class="segment"
        [(ngModel)]="lancarServicoProdutoSegment"
        (ionChange)="segmentChanged($event)"
        style="margin-bottom: 10px; margin-top: 10px"
      >
        <ion-segment-button
          value="servico"
          *ngIf="
            (registerServicePermission?.length != 0 &&
              parametrosLight.registrarServicos) ||
            tipoLogin === 'gestor'
          "
        >
          <ion-label id="servico" style="color:var(--cor-texto-escuro)">
            {{
              "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.SERVICOS"
                | translate
            }}
          </ion-label>
        </ion-segment-button>

        <ion-segment-button
          value="produto"
          *ngIf="
            (registerProductPermission?.length != 0 &&
              parametrosLight.lancarProdutos) ||
            tipoLogin === 'gestor'
          "
        >
          <ion-label id="produto" style="color: var(--cor-texto-claro)">
            {{
              "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.PRODUTOS"
                | translate
            }}
          </ion-label>
        </ion-segment-button>
      </ion-segment>

      <ng-container
        *ngIf="
          lancarServicoProdutoSegment == 'servico' &&
          (parametrosLight.registrarServicos || tipoLogin === 'gestor')
        "
      >
        <ion-row>
          <ion-col size="12">
            <kendo-floatinglabel
              text="{{
                'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.PESQUISARSERVICO'
                  | translate
              }}"
            >
              <kendo-combobox
                [data]="listServicosPesquisados"
                [filterable]="true"
                (filterChange)="pesquisaServicosParaRegistro($event)"
                (valueChange)="changeServicoSelecionado($event)"
                [textField]="'nomeServico'"
                [valueField]="'servicoId'"
                [valueNormalizer]="valueNormalizer"
                [allowCustom]="true"
                style="border: 0"
              >
                <!--[loading]="pesquisaClienteLoader"-->
                <ng-template kendoComboBoxItemTemplate let-dataItem>
                  <ion-row>
                    <ion-col>
                      <ion-row>
                        {{
                          "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.PESQUISA.NOMESERVICO"
                            | translate
                        }}: {{ dataItem.nomeServico }}
                      </ion-row>
                      <ion-row>
                        {{
                          "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.PESQUISA.PRECOSERVICO"
                            | translate
                        }}: {{ dataItem.precoServico }}
                      </ion-row>
                      <ion-row>
                        {{
                          "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.PESQUISA.DURACAOSERVICO"
                            | translate
                        }}: {{ dataItem.tempoExecucaoServico }}
                      </ion-row>
                    </ion-col>
                  </ion-row>
                </ng-template>
                <ng-template kendoComboBoxNoDataTemplate>
                  <ion-row>
                    {{ "AGENDA.BUSCANAORETORNOURESULTADO" | translate }}
                  </ion-row>
                </ng-template>
              </kendo-combobox>
            </kendo-floatinglabel>
          </ion-col>
        </ion-row>

        <ion-segment
          mode="md"
          class="SwipedTabs-tabs "
          style="overflow-x: scroll"
          scrollable
        >
          <ion-segment-button
            style="text-transform: capitalize; color: var(--cor-texto-escuro);"
            class="gservs"
            *ngFor="let gServico of gServicosDisponiveis; index as i"
            id="segment-{{ i }}"
            (click)="selectTab(i)"
          >
            {{ gServico.gservNome }}
          </ion-segment-button>
        </ion-segment>

        <ion-slides
          #SwipedTabsSlider
          (ionSlideDrag)="animateIndicator($event)"
          (ionSlideWillChange)="updateIndicatorPosition()"
          (ionSlideDidChange)="updateIndicatorPosition()"
          (pan)="updateIndicatorPosition()"
          [pager]="false"
        >
          <ng-container
            *ngFor="let gServico of gServicosDisponiveis; index as i"
          >
            <ion-slide style="overflow-y: auto"
              ><!--style="max-height: 340px; overflow-y: auto;" [ngStyle]="{'max-height': (innerHeight )}"-->
              <ng-container>
                <ion-icon 
                *ngIf="
                      indexAtualSegment != 0
                    "
                name="chevron-back-outline" style="color: blue; 
                                                              background-color: transparent;
                                                              margin-top: 13px;
                                                              margin-right: 5px;
                                                              position: relative;
                                                              float:right;
                                                              transform: scale(1.4);
                                                              "></ion-icon>
                <ion-card class="backgroundCard" style="width: 100%; box-shadow: none">
                  <ion-card-content
                  mode="md"
                  class="colorTextApp"
                    *ngIf="
                      indexAtualSegment == i ||
                      indexAtualSegment == i - 1 ||
                      indexAtualSegment == i + 1
                    "
                    [ngStyle]="{
                      'max-height': slideContentHeight,
                      'overflow-y': 'auto'
                    }"
                  >
                    <ng-container
                      *ngFor="let servico of gServico.servicos; index as j"
                    >
                      <!-- <ng-container *ngIf="indexAtualSegment == j"> -->
                      <ion-row style="padding-top: 10px">
                        <ion-col
                          mode="md"
                          size="1"
                          style="right: 5px; text-align: left"
                        >
                          <ion-checkbox class="backgroundCheckApp"
                            [(ngModel)]="controlServicos[i][j].checked"
                            (ngModelChange)="marcarServico(i, j)"
                          ></ion-checkbox
                        ></ion-col>
                        <!---->
                        <ion-col
                          mode="md"
                          size="11"
                          style="text-align: left"
                          (click)="checkBoxSelectionFromServiceText(i, j)"
                        >
                          {{ servico.nomeServico }}</ion-col
                        >
                      </ion-row>
                      <ng-container *ngIf="controlServicos != undefined">
                        <ion-row *ngIf="controlServicos[i][j].checked == true">
                          <ion-col size="4"> </ion-col>

                          <ion-col size="3">
                            <kendo-floatinglabel
                              text="{{
                                'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.QUANTIDADE'
                                  | translate
                              }}"
                            >
                              <kendo-numerictextbox
                                [autoCorrect]="true"
                                [format]="'n'"
                                [step]="1"
                                [(value)]="controlServicos[i][j].quantidade"
                                [min]="1"
                                [max]="null"
                                class="valor keyboardnumeric"
                                (click)="setKeyboardNumeric($event)"
                              >
                              </kendo-numerictextbox>
                            </kendo-floatinglabel>
                          </ion-col>
                          <ion-col size="5">
                            <kendo-floatinglabel
                              text="{{
                                'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.PRECO'
                                  | translate
                              }}"
                            >
                              <kendo-numerictextbox
                                [autoCorrect]="true"
                                [format]="formatOptions"
                                [step]="0.01"
                                [(value)]="
                                  controlServicos[i][j].precoConfigurado
                                "
                                [min]="controlServicos[i][j].descontoMax"
                                [max]="controlServicos[i][j].precoMax"
                                class="valor keyboardnumeric"
                                (click)="setKeyboardNumeric($event)"
                              >
                              </kendo-numerictextbox>
                            </kendo-floatinglabel>
                          </ion-col>
                        </ion-row>

                        <ion-row
                          *ngIf="
                            controlServicos[i][j].checked == true &&
                            servico.servicoAuxiliarID != null
                          "
                        >
                          <ion-col size="12">
                            <kendo-floatinglabel
                              text="{{
                                'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.PESQUISARAUXILIAR'
                                  | translate
                              }}"
                            >
                              <kendo-combobox
                                [data]="listColaboradoresAgendaveis"
                                [filterable]="true"
                                (filterChange)="pesquisaColaboradores($event)"
                                (valueChange)="changeColaborador($event, i, j)"
                                [textField]="'nomeProfissional'"
                                [valueField]="'profissionalId'"
                                [valueNormalizer]="valueNormalizer"
                                [allowCustom]="true"
                                style="border: 0"
                              >
                                <!--[loading]="pesquisaClienteLoader"-->
                                <ng-template
                                  kendoComboBoxItemTemplate
                                  let-dataItem
                                >
                                  <ion-grid class="pesquisa-container">
                                    <ion-row>
                                      <ion-col>
                                        {{
                                          "AGENDA.MODALS.NOVOAGENDAMENTOPROFISSIONAL.INFOCLIENTE.NAME"
                                            | translate
                                        }}:{{ dataItem.nomeProfissional }}
                                      </ion-col>
                                    </ion-row>
                                    <ion-row>
                                      <ion-col size="12">
                                        {{
                                          "AGENDA.MODALS.NOVOAGENDAMENTOPROFISSIONAL.INFOCLIENTE.EMAIL"
                                            | translate
                                        }}: {{ dataItem.email }}
                                      </ion-col>
                                    </ion-row>
                                    <ion-row>
                                      <ion-col size="12">
                                        {{
                                          "AGENDA.MODALS.NOVOAGENDAMENTOPROFISSIONAL.INFOCLIENTE.PHONE"
                                            | translate
                                        }}: {{ dataItem.celular }}
                                      </ion-col>
                                    </ion-row>
                                  </ion-grid>
                                </ng-template>
                                <ng-template kendoComboBoxNoDataTemplate>
                                  <ion-row>
                                    {{
                                      "AGENDA.BUSCANAORETORNOURESULTADO"
                                        | translate
                                    }}
                                  </ion-row>
                                </ng-template>
                              </kendo-combobox>
                            </kendo-floatinglabel>
                          </ion-col>
                        </ion-row>

                        <ion-row *ngIf="controlServicos[i][j].checked == true">
                          <ion-col size="12">
                            <kendo-floatinglabel
                              text="{{
                                'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.OBSERVACAO'
                                  | translate
                              }}"
                            >
                              <textarea
                                kendoTextArea
                                maxlength="199"
                                class="noBorder"
                                [(ngModel)]="controlServicos[i][j].observacao"
                                (ngModelChange)="onChange($event, i, j)"
                                style="width: 100% !important; resize: none"
                              ></textarea>
                            </kendo-floatinglabel>
                          </ion-col>
                        </ion-row>

                        <ng-container
                          *ngIf="
                            controlServicos[i][j].service.quimicas != null &&
                            controlServicos[i][j].service.quimicas?.length > 0 &&
                            controlServicos[i][j].checked == true
                          "
                        >
                          <ion-row
                            style="
                              display: flex;
                              align-items: center;
                              padding-left: 10px;
                            "
                            (click)="expandirQuimica(i, j)"
                          >
                            <ion-icon
                              name="arrow-down"
                              style="transform: scale(1.5); padding-right: 5px"
                              *ngIf="
                                controlServicos[i][j].expandirQuimicaControl ==
                                1
                              "
                            ></ion-icon>
                            <ion-icon
                              name="arrow-forward"
                              style="transform: scale(1.5); padding-right: 5px"
                              *ngIf="
                                controlServicos[i][j].expandirQuimicaControl ==
                                0
                              "
                            ></ion-icon
                            >{{
                              "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.LISTAQUIMICAS"
                                | translate
                            }}
                          </ion-row>
                          <ng-container
                            *ngIf="
                              controlServicos[i][j].expandirQuimicaControl == 1
                            "
                          >
                            <ion-row
                              *ngFor="
                                let quimica of controlServicos[i][j].service
                                  .quimicas;
                                index as quimicaIndex
                              "
                            >
                              <ion-col size="1"></ion-col>
                              <ion-col size="9" style="text-align: left">{{
                                quimica.produtoDescricao
                              }}</ion-col>

                              <ion-col size="1" style="bottom: 4px"
                                ><ion-icon
                                  name="create"
                                  style="
                                    transform: scale(1.5);
                                    color: gray;
                                    padding-right: 2.5px;
                                    position: absolute;
                                  "
                                  (click)="
                                    openModalEdicaoQuimica(i, quimicaIndex, j)
                                  "
                                ></ion-icon
                              ></ion-col>
                              <ion-col size="1" style="bottom: 8px"
                                ><ion-icon
                                  name="close"
                                  style="
                                    transform: scale(2.5);
                                    position: absolute;
                                    bottom: -8px;
                                    color: var(--ion-color-danger);
                                  "
                                  (click)="removerQuimica(i, j, quimicaIndex)"
                                ></ion-icon
                              ></ion-col>
                            </ion-row>
                          </ng-container>
                        </ng-container>

                        <ion-row
                          *ngIf="
                            controlServicos[i][j].checked == true &&
                            controlServicos[i][j].service.usaQuimica == true
                          "
                        >
                          <ion-button
                          class="backgroundButtonApp"
                            type="submit"
                            (click)="openModalQuimica(i, j)"
                            expand="block"
                            style="height: 40px; width: 100%"
                          >
                            <!-- [disabled]="(editarAgendamento == 0 ? (!servicoSelecionado || !clienteCadastrado || !horarioSelecionado? true: false) : )" -->
                            <!-- [disabled]="(segment == 'servicos'? marcados: (listNovosAgendamentos?.length == 0 ? true: false))"-->
                            <div
                              class="overlay"
                              *ngIf="overlayDivControl == true"
                            ></div>
                            <!-- <ion-icon name="add" style="zoom:2; padding-right: 5px;"></ion-icon> --><span class="backgroundButtonApp"
                              >{{
                                "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.ADICIONARQUIMICA"
                                  | translate
                              }}</span
                            >
                          </ion-button>
                        </ion-row>
                      </ng-container>

                      <!-- </ng-container> -->
                    </ng-container>
                  </ion-card-content>
                </ion-card>
                <ion-icon 
                *ngIf="
                      i != (gServicosDisponiveis.length - 1)
                    "
                name="chevron-forward-outline"  style="color: blue; 
                                              background-color: transparent;
                                              margin-top: 13px;
                                              margin-right: 5px;
                                              position: relative;
                                              float:right;
                                              transform: scale(1.4);
                                              "></ion-icon>
              </ng-container>
            </ion-slide>
          </ng-container>
        </ion-slides>
      </ng-container>

      <ng-container *ngIf="lancarServicoProdutoSegment == 'produto'">
        <ion-row>
          <ion-col size="12">
            <kendo-floatinglabel
              text="{{
                'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.PESQUISARPRODUTO'
                  | translate
              }}"
            >
              <kendo-combobox
                [data]="listProdutosPesquisados"
                [filterable]="true"
                (filterChange)="pesquisaProdutosParaRegistro($event)"
                (valueChange)="changeProdutoSelecionado($event)"
                [textField]="'descricaoProduto'"
                [valueField]="'produtoId'"
                [valueNormalizer]="valueNormalizer"
                [allowCustom]="true"
                style="border: 0"
              >
                <!--[loading]="pesquisaClienteLoader"-->
                <ng-template kendoComboBoxItemTemplate let-dataItem>
                  <ion-row>
                    <ion-col>
                      <ion-row>
                        {{
                          "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.PESQUISA.NOMEPRODUTO"
                            | translate
                        }}: {{ dataItem.descricaoProduto }}
                      </ion-row>
                      <ion-row>
                        {{
                          "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.PESQUISA.PRECOPRODUTO"
                            | translate
                        }}: {{ dataItem.precoVenda }}
                      </ion-row>
                      <ion-row>
                        {{
                          "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.PESQUISA.CODIGOPRODUTO"
                            | translate
                        }}: {{ dataItem.codigoBarras }}
                      </ion-row>
                    </ion-col>
                  </ion-row>
                </ng-template>
                <ng-template kendoComboBoxNoDataTemplate>
                  <ion-row>
                    {{ "AGENDA.BUSCANAORETORNOURESULTADO" | translate }}
                  </ion-row>
                </ng-template>
              </kendo-combobox>
            </kendo-floatinglabel>
          </ion-col>
        </ion-row>

        <ion-segment
          mode="md"
          class="SwipedTabs-tabs"
          style="overflow-x: scroll"
          scrollable
        >
          <ion-segment-button
            style="text-transform: capitalize; color: var(--cor-texto-escuro);"
            class="linhaProdutos"
            *ngFor="let produtoLinha of listProdutosDisponiveis; index as i"
            id="segment-{{ i }}"
            (click)="selectTab(i)"
          >
            {{ produtoLinha.descricaoLinha }}
          </ion-segment-button>
        </ion-segment>

        <ion-slides
          #SwipedTabsSlider
          (ionSlideDrag)="animateIndicator($event)"
          (ionSlideWillChange)="updateIndicatorPosition()"
          (ionSlideDidChange)="updateIndicatorPosition()"
          (pan)="updateIndicatorPosition()"
          [pager]="false"
        >
          <ng-container
            *ngFor="let produtoLinha of listProdutosDisponiveis; index as i"
          >
            <ion-slide style="overflow-y: auto">
              <ng-container>
                <ion-icon 
                *ngIf="
                      indexAtualSegment != 0
                    "
                name="chevron-back-outline"  style="color: blue; 
                                                              background-color: transparent;
                                                              margin-top: 13px;
                                                              margin-right: 5px;
                                                              position: relative;
                                                              float:right;
                                                              transform: scale(1.4);
                                                              "></ion-icon>
                <ion-card class="backgroundCard" style="width: 100%; box-shadow: none">
                  <ion-card-content
                    *ngIf="
                      indexAtualSegment == i ||
                      indexAtualSegment == i - 1 ||
                      indexAtualSegment == i + 1
                    "
                    [ngStyle]="{
                      'max-height': slideContentHeight,
                      'overflow-y': 'auto'
                    }"
                  >
                    <ng-container
                      *ngFor="let produto of produtoLinha.produtos; index as j"
                    >
                      <ion-row style="padding-top: 10px">
                        <ion-col
                          mode="md"
                          size="1"
                          style="right: 5px; text-align: left"
                        >
                          <ion-checkbox class="backgroundCheckApp"
                            [(ngModel)]="controlProdutos[i][j].checked"
                            (ngModelChange)="marcarProduto(i, j)"
                          ></ion-checkbox
                        ></ion-col>
                        <!---->
                        <ion-col
                          mode="md"
                          size="11"
                          style="text-align: left"
                          (click)="checkBoxSelectionFromProductText(i, j)"
                        >
                          {{ produto.descricaoProduto }}</ion-col
                        >
                      </ion-row>
                      <ng-container *ngIf="controlProdutos != undefined">
                        <ion-row *ngIf="controlProdutos[i][j].checked == true">
                          <ion-col size="4"></ion-col>
                          <ion-col size="3">
                            <kendo-floatinglabel
                              text="{{
                                'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.QUANTIDADE'
                                  | translate
                              }}"
                            >
                              <kendo-numerictextbox
                                [autoCorrect]="true"
                                [format]="'n'"
                                [step]="1"
                                [(value)]="controlProdutos[i][j].quantidade"
                                [min]="1"
                                [max]="
                                  controlProdutos[i][j].product
                                    .quantidadeEmEstoque == null
                                    ? null
                                    : controlProdutos[i][j].product
                                        .quantidadeEmEstoque
                                "
                                class="valor keyboardnumeric"
                                (click)="setKeyboardNumeric($event)"
                              >
                              </kendo-numerictextbox>
                            </kendo-floatinglabel>
                          </ion-col>
                          <ion-col size="5">
                            <kendo-floatinglabel
                              text="{{
                                'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.PRECO'
                                  | translate
                              }}"
                            >
                              <kendo-numerictextbox
                                [autoCorrect]="true"
                                [format]="formatOptions"
                                [step]="0.01"
                                [(value)]="
                                  controlProdutos[i][j].precoConfigurado
                                "
                                [min]="controlProdutos[i][j].descontoMax"
                                [max]="controlProdutos[i][j].precoMax"
                                class="valor keyboardnumeric"
                                (click)="setKeyboardNumeric($event)"
                              >
                              </kendo-numerictextbox>
                            </kendo-floatinglabel>
                          </ion-col>
                        </ion-row>
                        <ion-row style="text-align: center">
                          <ion-col>
                            <span
                              *ngIf="
                                controlProdutos[i][j].quantidade ==
                                controlProdutos[i][j].product
                                  .quantidadeEmEstoque
                              "
                              style="color: red; font-size: 11px"
                              >{{
                                "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.MENSAGEMESTOQUE"
                                  | translate
                              }}</span
                            >
                          </ion-col>
                        </ion-row>

                        <ion-row *ngIf="controlProdutos[i][j].checked == true">
                          <ion-col size="12">
                            <kendo-floatinglabel
                              text="*{{
                                'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.OBSERVACAO'
                                  | translate
                              }}"
                              class="textArea"
                            >
                              <textarea
                                kendoTextArea
                                maxlength="199"
                                [(ngModel)]="controlProdutos[i][j].observacao"
                                (ngModelChange)="onChange($event, i, j)"
                                style="width: 100% !important; resize: none"
                              ></textarea>
                            </kendo-floatinglabel>
                          </ion-col>
                        </ion-row>
                      </ng-container>
                    </ng-container>
                  </ion-card-content>
                </ion-card>
                <ion-icon 
                *ngIf="
                      i != (listProdutosDisponiveis.length - 1)
                    "
                name="chevron-forward-outline"  style="color: blue; 
                                              background-color: transparent;
                                              margin-top: 13px;
                                              margin-right: 5px;
                                              position: relative;
                                              float:right;
                                              transform: scale(1.4);
                                              "></ion-icon>
              </ng-container>
            </ion-slide>
          </ng-container>
        </ion-slides>
      </ng-container>
    </ion-list>
  </ng-container>
</ion-content>

<ion-footer
  class="ion-no-border backgroundFooterApp"
  *ngIf="
    (segment == 'info' &&
      dadosAgendamento.status != 'R' &&
      possuiFicha == true) ||
    segment == 'lancarProdutoServico'
  "
>
  <ion-toolbar style="text-align: -webkit-center" transparent>
    <!-- <ng-container *ngIf="dadosAgendamento.status != 'E' && segment == 'info' && dadosAgendamento.status != 'R' && possuiFicha == true">
      <div class="overlay" *ngIf="overlayDivControl == true"></div>
      <span (click)="buttonSlided()" style="padding: 20px; padding-right: 10px; background-color: #59e580; border-radius: 10px; color: white;" ><span style="margin-right: 10px; margin-left: 10px; border-radius: 50%; background-color: #53d377; width: 50px; height: 50px; display: inline-flex; align-items: center; justify-content: center;"><ion-icon name="arrow-forward"></ion-icon><ion-icon name="arrow-forward"></ion-icon></span> {{'AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.FINALIZARBUTTON' | translate}}</span>
    </ng-container> -->

    <ion-button
      *ngIf="
        dadosAgendamento.status != 'E' &&
        segment == 'info' &&
        dadosAgendamento.status != 'R' &&
        possuiFicha == true &&
        tipoUsuario == 'colaborador'
      "
      class="finalizarAtend backgroundButtonApp"
      expand="block"
      type="submit"
      (click)="buttonSlided()"
      style="width: 60%"
    >
      <ion-icon
        name="checkmark-done-outline"
        style="transform: scale(1.3); padding-right: 5px"
      ></ion-icon
      ><span style="font-size: 14px; color: var(--cor-texto-botaoAgendar);">{{
        "AGENDA.MODALS.RESUMOAGENDAMENTO.FINALIZAATENDIMENTO.BUTTON" | translate
      }}</span>
    </ion-button>

    <ion-button
      *ngIf="
        (segment == 'info' &&
          dadosAgendamento.status != 'R' &&
          possuiFicha == true &&
          tipoUsuario != 'colaborador') ||
        (dadosAgendamento.status == 'E' &&
          segment == 'info' &&
          dadosAgendamento.status != 'R' &&
          possuiFicha == true &&
          tipoUsuario == 'colaborador')
      "
      class="finalizarAtend backgroundButtonApp"
      expand="block"
      type="submit"
      (click)="closeModal()"
      style="width: 60%"
    >
      <span style="font-size: 14px; color: var(--cor-texto-botaoAgendar);">{{
        "AGENDA.MODALS.RESUMOAGENDAMENTO.FECHARMODAL.BUTTON" | translate
      }}</span>
    </ion-button>

    <ng-container *ngIf="segment == 'lancarProdutoServico'">
      <ion-button class="backgroundButtonApp"
        [disabled]="
          servicosSelecionados?.length == 0 && produtosSelecionados?.length == 0
            ? true
            : launchButtonWaitingAPI == true
            ? true
            : false
        "
        type="submit"
        (click)="lancarServicosProdutos()"
        expand="block"
        style="height: 40px"
      >
        <!-- [disabled]="(editarAgendamento == 0 ? (!servicoSelecionado || !clienteCadastrado || !horarioSelecionado? true: false) : )" -->
        <!-- [disabled]="(segment == 'servicos'? marcados: (listNovosAgendamentos?.length == 0 ? true: false))"-->
        <div class="overlay" *ngIf="overlayDivControl == true"></div>
        <ion-icon
          name="add"
          style="transform: scale(1.5); padding-right: 5px; color: var(--cor-texto-botaoAgendar);"
        ></ion-icon
        ><span style="color: var(--cor-texto-botaoAgendar);"
          >{{
            "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.BUTTONTITLE"
              | translate
          }}
          {{
            "AGENDA.MODALS.RESUMOAGENDAMENTO.LANCARSERVICOPRODUTO.SERVICOSPRODUTOS"
              | translate
          }}</span
        >
      </ion-button>
    </ng-container>
  </ion-toolbar>
</ion-footer>
